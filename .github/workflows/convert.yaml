name: Build & Bundle for static server then push to gh-pages branch
on:
  push:
    branches:
        - main
permissions:
    contents: write
jobs:
    build:
      runs-on: ubuntu-latest
      steps:
      - name: Checkout
        uses: actions/checkout@v2
        with:
          persist-credentials: false # otherwise, the token used is the GITHUB_TOKEN, instead of your personal token
      - name: build
        run: |
          npm install
          npm run build 
          npm run bundle
          npm run minify
      - name: Deploy to Github Pages
        uses: JamesIves/github-pages-deploy-action@4.1.4 
        with:
          BRANCH: gh-pages
          FOLDER: ./
          CLEAN: true

